
<div style="padding-left: 10px;padding-top: 10px;padding-right: 10px;margin-bottom: 10px;
">
  <div class="fixHeader" id="myHeader">
    <mat-card style="background-color: #03a9f4; color:white; padding: 15px;">
      <mat-card-title>Billing
          <!-- <button style="    margin-right: 10px;
          float: right;
          background-color: white;
          color: black !important; "
          class="btn btn-primary mat-ripple" md-ripple="submit"  (click)="save()">save</button>&nbsp;&nbsp; -->
           <button style="margin-right: 10px;
          float: right;
          background-color: white;
          color: black !important;"
            class="btn btn-primary mat-ripple" md-ripple="submit" (click)="open(basic)">Save</button> &nbsp;&nbsp;
            <button style="margin-right: 10px;
            float: right;
            background-color: white;
            color: black !important;"
              class="btn btn-primary mat-ripple" md-ripple="submit" (click)="new(basic1)">Raise Discharge</button> &nbsp;&nbsp;
           
            <!-- <button style="margin-right: 10px;
          float: right;
          background-color: white;
          color: black !important;"
            class="btn btn-primary mat-ripple" md-ripple="submit" (click)="discharge()">Raise Discharge</button> &nbsp;&nbsp; 
      -->
      </mat-card-title>
           
     

    </mat-card>
  </div>

</div>
<div class="content">
  <div style="padding-left:10px;padding-right:10px">
    <mat-card style="padding-left:50infopx;">

      <form class="form-horizontal" class="form-inline" [formGroup]="BillForm">

        <div class="row">
         
          <div class="col-md-6">
            <div class="form-group">
              <div class="col-xl">
                <mat-form-field>
                  <input  [(ngModel)]="regId" formControlName="regId"  matInput placeholder="REG#"  (keyup.enter)="showBillDetails(this.regId)">

                </mat-form-field>

              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <div class="col-xl">

                <mat-form-field>

                  <input [value]="Array[0]?Array[0][0].pType:''"  matInput placeholder="Type Of Patient" type="text" readonly>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <div class="col-xl">

                <mat-form-field>

                  <input [value]="Array[0]?Array[0][0].doj:''"  matInput placeholder="DOJ" type="text">
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <div class="col-xl">

                <mat-form-field>

                  <input  matInput placeholder="BILLGENERATED BY" type="text">
                </mat-form-field>
              </div>
            </div>
          </div>
        </div>
      </form>
    </mat-card>
  </div>

  <div style="padding-left:10px;padding-top:10px;padding-right:10px">
    
      <table width="100%"  class="table table-striped table-condensed table-editable" style="overflow-y: scroll;">
        <tr style="background:rgb(53, 49, 49)">
          <th>Sno</th>
          <th>Billable charge</th>
          <th>Amount</th>
          <th>Quantity</th>
          <th>Discount</th>
          <th>Net Amount</th>
          <th>Paid</th>
      <!-- <th>Confirm</th> -->
         
        </tr>
    <tr *ngFor="let data of Array[1]|paginate: { itemsPerPage: 5, currentPage: p };let i=index">
      <td>{{i+1}}</td>
      <td>
         <mat-form-field>
        <input type="text" (blur)="data.serviceName = $event.target.value" [value]="data.serviceName" matInput placeholder="ServiceName" readonly>
         </mat-form-field>
      </td>
      <td>
        <mat-form-field>
        <input type="text"  (blur)="data.amount = $event.target.value" [value]="data.amount" matInput placeholder="Amount" readonly>
        </mat-form-field>
      </td>
      <td>
          <mat-form-field>
        <input type="number"(blur)="data.quantity = $event.target.value" [value]="data.quantity" matInput placeholder="Quantity" readonly>
          </mat-form-field>
      </td>
      <td>
          <mat-form-field>
        <input type="text" (blur)="data.discount = $event.target.value" [value]="data.discount" matInput placeholder="Discount" readonly>
          </mat-form-field>
      </td>
      <td>
         <mat-form-field>
        <input type="text"  (blur)="data.netAmount = $event.target.value" [value]="(data.amount)-((data.amount)*(data.discount/100))"  matInput placeholder="NetAmount" readonly>
         </mat-form-field>
          </td>
      <td>
      
        <input type="text"  (blur)="data.paid = $event.target.value" [value]="data.paid" matInput placeholder="Paid" disabled>
     
      </td>
      <!-- <td><button class="btn btn-primary"  (click)="hai(i,data)">save</button> </td> -->
    </tr>
      </table>
      <pagination-controls (pageChange)="p = $event"></pagination-controls> 
    </div>
    <!-- bill :: {{ bill | json}}  -->
    <div style="padding-left:10px;padding-right:10px">
      <table class="table table-striped table-condensed" style="overflow-y: scroll; min-height:100%">
        <tr style="background:rgb(53, 49, 49)">
          <th>Sno</th>
          <th>Service Name</th>
          <th>Cost</th>
          <th>Quantity</th>
          <th>Discount</th>
          <th>Amount</th>
          <th>Manage</th>
          <!-- <th>Save</th> -->
    
        </tr>
        <tr *ngFor="let data of bill;let i= index">
          <td>{{i + 1}}</td>
          <td>
   
             <mat-select placeholder="Service Name" (selectionChange)="setDetails(data)" [(ngModel)]="data.chargeName"  #singleSelect>
                <ngx-mat-select-search></ngx-mat-select-search>
                <mat-option>None</mat-option>
                <mat-option  *ngFor="let data of Array[2]" [value]="data.name">{{data.name}}</mat-option>
              </mat-select> 
              <!-- <ngx-select-dropdown  [multiple]="true" [(value)]="data.name" [config]="Array[2]" [options]="data.name"></ngx-select-dropdown> -->
              <!-- <ng-select [items]="Array[2]" (change)="setDetails(chargeName)"
             bindLabel="name"
          
              
              placeholder="Select ServiceName"
              [(ngModel)]="chargeName">
   </ng-select> -->
          </td>
          <td>
              <input  [(ngModel)]="data.cost" placeholder="Cost" type="text" readonly>
            </td> 
             <td>
              <input  [(ngModel)]="data.quantity" placeholder="Quantity"  (change)="calcAmount(data)" type="text">
            </td> 
             <td>
                <input   [(ngModel)]="data.discount"  (change)="calcAmount(data)" placeholder="Discount" type="text" (keydown.tab)="addMore($event)" (keydown.enter)="addMore($event)">
              </td>   
              <td>
                  <input   [(ngModel)]="data.netAmount"   placeholder="Amount" type="text" (keydown.tab)="addMore($event)" (keydown.enter)="addMore($event)">
                </td>  
              <td>
                  <a  (click)="removeSaleItem(i);"><i class="fa fa-close" style="font-size:18px;color:red"></i></a>
                  </td>
           

          
        </tr>
          </table>
        
        </div> 

        
<ng-template #basic let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">ConFormation</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                  <span aria-hidden="true">&times;</span>
                </button>
    </div>
    <div class="modal-body">
    
        
        <table id="classTable" class="table table-bordered" style="overflow-y: scroll;overflow-x:auto">
            <tr style="background:rgb(53, 49, 49);font-size:13px">
             
             
               
                      <th>Sno</th>
                      <th>Billable charge</th>
                      <th>Amount</th>
                      <th>Quantity</th>
                      <th>Discount</th>
                      <th>Net Amount</th>
                      <th>Paid</th>
                  <!-- <th>Confirm</th> -->
                     
                    </tr>
                <tr *ngFor="let data of Array[1]|paginate: { itemsPerPage: 5, currentPage: p };let i=index">
                  <td>{{i+1}}</td>
                  <td>
                     <mat-form-field>
                    <input type="text" (blur)="data.serviceName = $event.target.value" [value]="data.serviceName" matInput placeholder="ServiceName" readonly>
                     </mat-form-field>
                  </td>
                  <td>
                    <mat-form-field>
                    <input type="text"  (blur)="data.amount = $event.target.value" [value]="data.amount" matInput placeholder="Amount" readonly>
                    </mat-form-field>
                  </td>
                  <td>
                      <mat-form-field>
                    <input type="number"(blur)="data.quantity = $event.target.value" [value]="data.quantity" matInput placeholder="Quantity" readonly>
                      </mat-form-field>
                  </td>
                  <td>
                      <mat-form-field>
                    <input type="text" (blur)="data.discount = $event.target.value" [value]="data.discount" matInput placeholder="Discount" readonly>
                      </mat-form-field>
                  </td>
                  <td>
                     <mat-form-field>
                    <input type="text"  (blur)="data.netAmount = $event.target.value" [value]="(data.amount)-((data.amount)*(data.discount/100))"  matInput placeholder="NetAmount" readonly>
                     </mat-form-field>
                      </td>
                  <td>
                  
                    <input type="text"  (blur)="data.paid = $event.target.value" [value]="data.paid" matInput placeholder="Paid" disabled>
                 
                  </td>
                  <!-- <td><button class="btn btn-primary"  (click)="hai(i,data)">save</button> </td> -->
              
        </tr>
        </table>
      
      <table id="classTable" class="table table-bordered" style="overflow-y: scroll;">
          <tr style="background:rgb(53, 49, 49);font-size:13px">
              <th>Sno</th>
              <th>Service Name</th>
              <th>Cost</th>
              <th>Quantity</th>
              <th>Discount</th>
              <th>Amount</th>
              <th>Manage</th>
              <!-- <th>Save</th> -->
        
            </tr>
            
      <tr *ngFor="let data of bill;let i= index">
        <td>{{i + 1}}</td>
        <td>
 
           <mat-select placeholder="Service Name" (selectionChange)="setDetails(data)" [(ngModel)]="data.chargeName"  #singleSelect>
              <ngx-mat-select-search></ngx-mat-select-search>
              <mat-option>None</mat-option>
              <mat-option  *ngFor="let data of Array[2]" [value]="data.name">{{data.name}}</mat-option>
            </mat-select> 
            <!-- <ngx-select-dropdown  [multiple]="true" [(value)]="data.name" [config]="Array[2]" [options]="data.name"></ngx-select-dropdown> -->
            <!-- <ng-select [items]="Array[2]" (change)="setDetails(chargeName)"
           bindLabel="name"
        
            
            placeholder="Select ServiceName"
            [(ngModel)]="chargeName">
 </ng-select> -->
        </td>
        <td>
            <input  [(ngModel)]="data.cost" placeholder="Cost" type="text" readonly>
          </td> 
           <td>
            <input  [(ngModel)]="data.quantity" placeholder="Quantity"  (change)="calcAmount(data)" type="text">
          </td> 
           <td>
              <input   [(ngModel)]="data.discount"  (change)="calcAmount(data)" placeholder="Discount" type="text" (keydown.tab)="addMore($event)" (keydown.enter)="addMore($event)">
            </td>   
            <td>
                <input   [(ngModel)]="data.netAmount"   placeholder="Amount" type="text" (keydown.tab)="addMore($event)" (keydown.enter)="addMore($event)">
              </td>  
            <td>
                <a  (click)="removeSaleItem(i);"><i class="fa fa-close" style="font-size:18px;color:red"></i></a>
                </td>
      
          </tr>
          </table>

        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark"  (click)="save()">SAVE</button>
      
      
          </div>
      </ng-template>

              
<ng-template #basic1 let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Discharge Information</h4>
      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                  <span aria-hidden="true">&times;</span>
                </button>
    </div>
    <div class="modal-body">
        <button type="button" class="btn btn-outline-primary" (click)="discharge()">Print Discharge Summary</button>&nbsp;
        <button type="button" class="btn btn-outline-danger" (click)="modal.close('Save click')">Discharge slip</button>
    </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline-dark" (click)="modal.close('Save click')">CLOSE</button>
      
      
          </div>
          </ng-template>